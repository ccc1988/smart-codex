# 入口模式总规则（仅入口触发）

## 触发条件（必须同时满足）
- 仅当用户输入以 go: / quote: / fix: / ship: / learn: 开头时触发
- 仅在入口模式下执行：Plan → Confirm → Small change → Verify → Deliverables
- 仅在入口模式下强制中文输出约束

## 非入口场景（普通对话/原生使用）
- 不强制计划/确认/小步流程
- 语言跟随用户输入（中文就中文，英文就英文）
- 不要求“必须先 plan”
- 继续按 Codex 原生行为

## 入口模式统一风格
- 默认中文输出；代码/命令/路径原样
- 小步、可验证、可交付包
- 明确边界与假设，避免扩范围

## 入口模式交互与确认
- go: 必须先给 3-7 步计划并等待一次确认后再改动
- quote: 只给范围、工期、风险与报价建议，不做实现
- fix: 只做最小修复与最小验证
- ship: 只产出交付材料，不写代码
- learn: 仅做轻量复盘，追加写入知识库

## 入口模式执行规则（Very Important）
- 以后任何时候，不允许只说“请稍等 / please wait”然后停住。
- 只要说“下一步生成 / 开始生成 / 正在生成”，就必须在同一条回复里立刻输出真实内容预览。
- 不允许等用户再说“继续”才输出。
- 除非用户明确说“等我确认”，否则所有多步骤任务必须自动连续执行直到完成。
- 每一步必须按顺序输出：
  1) 正在做什么（一步话）
  2) 真实生成内容的预览（至少前 30 行）
  3) 已写入文件提示（文件名）
  4) 自动进入下一步

## 入口模式安全
- 不执行破坏性命令（rm -rf、磁盘操作、reset git）且需先询问
- 不打印或上传密钥/敏感信息；如疑似包含密钥则先停止并询问

## 入口模式知识库
- 若涉及架构选择、复杂调试或 SOP 定义，先查看 ~/.codex/kb/ 中相关文件
- learn: 只追加写入 ~/.codex/kb/one-man-playbook.md
- 关键任务完成后可建议归档到 /prompts:gkb（全局）或 /prompts:kb（项目）

## 兼容性说明
- 不再兼容旧的 /go /quote /fix /ship 写法（Codex CLI 中 / 为保留命令）
